"""core.py

Provides a container class for TREAT core lattice

"""

import common_files.treat.constants as c
from common_files.treat.corebuilder import TemplatedLattice

# Set some parameters for the positioning of each of the excore graphite permanent reflector movable blocks
# These are set here in the local directory so that each full core model can have the reflector holes either open or closed
# as needed.
# The parameter for each hole will be a fraction ranging from 0 (fully closed) to 1 (fully open)
excorePermReflNHolePosition = 0.00
excorePermReflWHolePosition = 0.00
excorePermReflSHolePosition = 0.00

class Core(object):

  #################################################################################################################################################
  # The core lattice template list contains all of the spots in the core grid. This provides the shape of the lattice to corebuilder, and
  # should always be completely full
  core_lattice_template = [
    ['A___1', 'B___1', 'C___1', 'D___1', 'E___1', 'F___1', 'G___1', 'H___1', 'J___1', 'K___1', 'L___1', 'M___1', 'N___1', 'O___1', 'P___1', 'R___1', 'S___1', 'T___1', 'U___1'],
    ['A___2', 'B___2', 'C___2', 'D___2', 'E___2', 'F___2', 'G___2', 'H___2', 'J___2', 'K___2', 'L___2', 'M___2', 'N___2', 'O___2', 'P___2', 'R___2', 'S___2', 'T___2', 'U___2'],
    ['A___3', 'B___3', 'C___3', 'D___3', 'E___3', 'F___3', 'G___3', 'H___3', 'J___3', 'K___3', 'L___3', 'M___3', 'N___3', 'O___3', 'P___3', 'R___3', 'S___3', 'T___3', 'U___3'],
    ['A___4', 'B___4', 'C___4', 'D___4', 'E___4', 'F___4', 'G___4', 'H___4', 'J___4', 'K___4', 'L___4', 'M___4', 'N___4', 'O___4', 'P___4', 'R___4', 'S___4', 'T___4', 'U___4'],
    ['A___5', 'B___5', 'C___5', 'D___5', 'E___5', 'F___5', 'G___5', 'H___5', 'J___5', 'K___5', 'L___5', 'M___5', 'N___5', 'O___5', 'P___5', 'R___5', 'S___5', 'T___5', 'U___5'],
    ['A___6', 'B___6', 'C___6', 'D___6', 'E___6', 'F___6', 'G___6', 'H___6', 'J___6', 'K___6', 'L___6', 'M___6', 'N___6', 'O___6', 'P___6', 'R___6', 'S___6', 'T___6', 'U___6'],
    ['A___7', 'B___7', 'C___7', 'D___7', 'E___7', 'F___7', 'G___7', 'H___7', 'J___7', 'K___7', 'L___7', 'M___7', 'N___7', 'O___7', 'P___7', 'R___7', 'S___7', 'T___7', 'U___7'],
    ['A___8', 'B___8', 'C___8', 'D___8', 'E___8', 'F___8', 'G___8', 'H___8', 'J___8', 'K___8', 'L___8', 'M___8', 'N___8', 'O___8', 'P___8', 'R___8', 'S___8', 'T___8', 'U___8'],
    ['A___9', 'B___9', 'C___9', 'D___9', 'E___9', 'F___9', 'G___9', 'H___9', 'J___9', 'K___9', 'L___9', 'M___9', 'N___9', 'O___9', 'P___9', 'R___9', 'S___9', 'T___9', 'U___9'],
    ['A__10', 'B__10', 'C__10', 'D__10', 'E__10', 'F__10', 'G__10', 'H__10', 'J__10', 'K__10', 'L__10', 'M__10', 'N__10', 'O__10', 'P__10', 'R__10', 'S__10', 'T__10', 'U__10'],
    ['A__11', 'B__11', 'C__11', 'D__11', 'E__11', 'F__11', 'G__11', 'H__11', 'J__11', 'K__11', 'L__11', 'M__11', 'N__11', 'O__11', 'P__11', 'R__11', 'S__11', 'T__11', 'U__11'],
    ['A__12', 'B__12', 'C__12', 'D__12', 'E__12', 'F__12', 'G__12', 'H__12', 'J__12', 'K__12', 'L__12', 'M__12', 'N__12', 'O__12', 'P__12', 'R__12', 'S__12', 'T__12', 'U__12'],
    ['A__13', 'B__13', 'C__13', 'D__13', 'E__13', 'F__13', 'G__13', 'H__13', 'J__13', 'K__13', 'L__13', 'M__13', 'N__13', 'O__13', 'P__13', 'R__13', 'S__13', 'T__13', 'U__13'],
    ['A__14', 'B__14', 'C__14', 'D__14', 'E__14', 'F__14', 'G__14', 'H__14', 'J__14', 'K__14', 'L__14', 'M__14', 'N__14', 'O__14', 'P__14', 'R__14', 'S__14', 'T__14', 'U__14'],
    ['A__15', 'B__15', 'C__15', 'D__15', 'E__15', 'F__15', 'G__15', 'H__15', 'J__15', 'K__15', 'L__15', 'M__15', 'N__15', 'O__15', 'P__15', 'R__15', 'S__15', 'T__15', 'U__15'],
    ['A__16', 'B__16', 'C__16', 'D__16', 'E__16', 'F__16', 'G__16', 'H__16', 'J__16', 'K__16', 'L__16', 'M__16', 'N__16', 'O__16', 'P__16', 'R__16', 'S__16', 'T__16', 'U__16'],
    ['A__17', 'B__17', 'C__17', 'D__17', 'E__17', 'F__17', 'G__17', 'H__17', 'J__17', 'K__17', 'L__17', 'M__17', 'N__17', 'O__17', 'P__17', 'R__17', 'S__17', 'T__17', 'U__17'],
    ['A__18', 'B__18', 'C__18', 'D__18', 'E__18', 'F__18', 'G__18', 'H__18', 'J__18', 'K__18', 'L__18', 'M__18', 'N__18', 'O__18', 'P__18', 'R__18', 'S__18', 'T__18', 'U__18'],
    ['A__19', 'B__19', 'C__19', 'D__19', 'E__19', 'F__19', 'G__19', 'H__19', 'J__19', 'K__19', 'L__19', 'M__19', 'N__19', 'O__19', 'P__19', 'R__19', 'S__19', 'T__19', 'U__19'],
  ]

  # Positions that have standard elements we wish to autofill from the elements file. In most cases, this will look very similar to the 
  # core_lattice_template, but as a single list instead of an ordered lattice. Element locations would be left empty here if there was a 
  # lattice position that we did not want to autofill (e.g. a gap with pure air from an assembly being left out, or an experimental test position)
  core_positions = [
    'A___1', 'B___1', 'C___1', 'D___1', 'E___1', 'F___1', 'G___1', 'H___1', 'J___1', 'K___1', 'L___1', 'M___1', 'N___1', 'O___1', 'P___1', 'R___1', 'S___1', 'T___1', 'U___1',
    'A___2', 'B___2', 'C___2', 'D___2', 'E___2', 'F___2', 'G___2', 'H___2', 'J___2', 'K___2', 'L___2', 'M___2', 'N___2', 'O___2', 'P___2', 'R___2', 'S___2', 'T___2', 'U___2',
    'A___3', 'B___3', 'C___3', 'D___3', 'E___3', 'F___3', 'G___3', 'H___3', 'J___3', 'K___3', 'L___3', 'M___3', 'N___3', 'O___3', 'P___3', 'R___3', 'S___3', 'T___3', 'U___3',
    'A___4', 'B___4', 'C___4', 'D___4', 'E___4', 'F___4', 'G___4', 'H___4', 'J___4', 'K___4', 'L___4', 'M___4', 'N___4', 'O___4', 'P___4', 'R___4', 'S___4', 'T___4', 'U___4',
    'A___5', 'B___5', 'C___5', 'D___5', 'E___5', 'F___5', 'G___5', 'H___5', 'J___5', 'K___5', 'L___5', 'M___5', 'N___5', 'O___5', 'P___5', 'R___5', 'S___5', 'T___5', 'U___5',
    'A___6', 'B___6', 'C___6', 'D___6', 'E___6', 'F___6', 'G___6', 'H___6', 'J___6', 'K___6', 'L___6', 'M___6', 'N___6', 'O___6', 'P___6', 'R___6', 'S___6', 'T___6', 'U___6',
    'A___7', 'B___7', 'C___7', 'D___7', 'E___7', 'F___7', 'G___7', 'H___7', 'J___7', 'K___7', 'L___7', 'M___7', 'N___7', 'O___7', 'P___7', 'R___7', 'S___7', 'T___7', 'U___7',
    'A___8', 'B___8', 'C___8', 'D___8', 'E___8', 'F___8', 'G___8', 'H___8', 'J___8', 'K___8', 'L___8', 'M___8', 'N___8', 'O___8', 'P___8', 'R___8', 'S___8', 'T___8', 'U___8',
    'A___9', 'B___9', 'C___9', 'D___9', 'E___9', 'F___9', 'G___9', 'H___9', 'J___9', 'K___9', 'L___9', 'M___9', 'N___9', 'O___9', 'P___9', 'R___9', 'S___9', 'T___9', 'U___9',
    'A__10', 'B__10', 'C__10', 'D__10', 'E__10', 'F__10', 'G__10', 'H__10', 'J__10', 'K__10', 'L__10', 'M__10', 'N__10', 'O__10', 'P__10', 'R__10', 'S__10', 'T__10', 'U__10',
    'A__11', 'B__11', 'C__11', 'D__11', 'E__11', 'F__11', 'G__11', 'H__11', 'J__11', 'K__11', 'L__11', 'M__11', 'N__11', 'O__11', 'P__11', 'R__11', 'S__11', 'T__11', 'U__11',
    'A__12', 'B__12', 'C__12', 'D__12', 'E__12', 'F__12', 'G__12', 'H__12', 'J__12', 'K__12', 'L__12', 'M__12', 'N__12', 'O__12', 'P__12', 'R__12', 'S__12', 'T__12', 'U__12',
    'A__13', 'B__13', 'C__13', 'D__13', 'E__13', 'F__13', 'G__13', 'H__13', 'J__13', 'K__13', 'L__13', 'M__13', 'N__13', 'O__13', 'P__13', 'R__13', 'S__13', 'T__13', 'U__13',
    'A__14', 'B__14', 'C__14', 'D__14', 'E__14', 'F__14', 'G__14', 'H__14', 'J__14', 'K__14', 'L__14', 'M__14', 'N__14', 'O__14', 'P__14', 'R__14', 'S__14', 'T__14', 'U__14',
    'A__15', 'B__15', 'C__15', 'D__15', 'E__15', 'F__15', 'G__15', 'H__15', 'J__15', 'K__15', 'L__15', 'M__15', 'N__15', 'O__15', 'P__15', 'R__15', 'S__15', 'T__15', 'U__15',
    'A__16', 'B__16', 'C__16', 'D__16', 'E__16', 'F__16', 'G__16', 'H__16', 'J__16', 'K__16', 'L__16', 'M__16', 'N__16', 'O__16', 'P__16', 'R__16', 'S__16', 'T__16', 'U__16',
    'A__17', 'B__17', 'C__17', 'D__17', 'E__17', 'F__17', 'G__17', 'H__17', 'J__17', 'K__17', 'L__17', 'M__17', 'N__17', 'O__17', 'P__17', 'R__17', 'S__17', 'T__17', 'U__17',
    'A__18', 'B__18', 'C__18', 'D__18', 'E__18', 'F__18', 'G__18', 'H__18', 'J__18', 'K__18', 'L__18', 'M__18', 'N__18', 'O__18', 'P__18', 'R__18', 'S__18', 'T__18', 'U__18',
    'A__19', 'B__19', 'C__19', 'D__19', 'E__19', 'F__19', 'G__19', 'H__19', 'J__19', 'K__19', 'L__19', 'M__19', 'N__19', 'O__19', 'P__19', 'R__19', 'S__19', 'T__19', 'U__19'
  ]
  #################################################################################################################################################

  def __init__(self, elements, has_experiment=False):
    """ Creates TREAT core lattice universe """
    
    self.elements = elements
    self.has_experiment = has_experiment

    self.NBlockPos = excorePermReflNHolePosition
    self.WBlockPos = excorePermReflWHolePosition
    self.SBlockPos = excorePermReflSHolePosition

    self._set_weight_percent_positions()
    self._set_boron_ppm_positions()
    self._set_cladding_positions()
    self._set_slot_positions()
    self._set_rcca_positions()
    self._make_core_universe()
    
  def _set_weight_percent_positions(self):
    """ Sets the specification for TREAT assembly fuel weight percent positions """
    
  #################################################################################################################################################
  # Sets the fuel weight percent in each autofilled element position. At the moment, 0.211% is the only option.
    self.fuel_wgt_positions ={
                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                'G___4':'0.211%', 'H___4':'0.211%', 'J___4':'0.211%',                   'L___4':'0.211%', 'M___4':'0.211%', 'N___4':'0.211%',                                                                                                           
                                                                                              'F___5':'0.211%', 'G___5':'0.211%', 'H___5':'0.211%', 'J___5':'0.211%', 'K___5':'0.211%', 'L___5':'0.211%', 'M___5':'0.211%', 'N___5':'0.211%', 'O___5':'0.211%',                                                                                         
                                                                            'E___6':'0.211%', 'F___6':'0.211%', 'G___6':'0.211%', 'H___6':'0.211%', 'J___6':'0.211%', 'K___6':'0.211%', 'L___6':'0.211%', 'M___6':'0.211%', 'N___6':'0.211%', 'O___6':'0.211%', 'P___6':'0.211%',                                                                       
                                                          'D___7':'0.211%', 'E___7':'0.211%', 'F___7':'0.211%', 'G___7':'0.211%', 'H___7':'0.211%', 'J___7':'0.211%', 'K___7':'0.211%', 'L___7':'0.211%', 'M___7':'0.211%', 'N___7':'0.211%', 'O___7':'0.211%', 'P___7':'0.211%', 'R___7':'0.211%',                                                     
                                                          'D___8':'0.211%', 'E___8':'0.211%', 'F___8':'0.211%', 'G___8':'0.211%', 'H___8':'0.211%', 'J___8':'0.211%', 'K___8':'0.211%', 'L___8':'0.211%', 'M___8':'0.211%', 'N___8':'0.211%', 'O___8':'0.211%', 'P___8':'0.211%', 'R___8':'0.211%',                                                     
                                                          'D___9':'0.211%', 'E___9':'0.211%', 'F___9':'0.211%', 'G___9':'0.211%', 'H___9':'0.211%', 'J___9':'0.211%', 'K___9':'0.211%', 'L___9':'0.211%', 'M___9':'0.211%', 'N___9':'0.211%', 'O___9':'0.211%', 'P___9':'0.211%', 'R___9':'0.211%',                                                     
                                                                            'E__10':'0.211%', 'F__10':'0.211%', 'G__10':'0.211%', 'H__10':'0.211%', 'J__10':'0.211%', 'K__10':'0.211%', 'L__10':'0.211%', 'M__10':'0.211%', 'N__10':'0.211%', 'O__10':'0.211%', 'P__10':'0.211%',                                                                       
                                                          'D__11':'0.211%', 'E__11':'0.211%', 'F__11':'0.211%', 'G__11':'0.211%', 'H__11':'0.211%', 'J__11':'0.211%', 'K__11':'0.211%', 'L__11':'0.211%', 'M__11':'0.211%', 'N__11':'0.211%', 'O__11':'0.211%', 'P__11':'0.211%', 'R__11':'0.211%',                                                     
                                                          'D__12':'0.211%', 'E__12':'0.211%', 'F__12':'0.211%', 'G__12':'0.211%', 'H__12':'0.211%', 'J__12':'0.211%', 'K__12':'0.211%', 'L__12':'0.211%', 'M__12':'0.211%', 'N__12':'0.211%', 'O__12':'0.211%', 'P__12':'0.211%', 'R__12':'0.211%',                                                     
                                                          'D__13':'0.211%', 'E__13':'0.211%', 'F__13':'0.211%', 'G__13':'0.211%', 'H__13':'0.211%', 'J__13':'0.211%', 'K__13':'0.211%', 'L__13':'0.211%', 'M__13':'0.211%', 'N__13':'0.211%', 'O__13':'0.211%', 'P__13':'0.211%', 'R__13':'0.211%',                                                     
                                                                            'E__14':'0.211%', 'F__14':'0.211%', 'G__14':'0.211%', 'H__14':'0.211%', 'J__14':'0.211%', 'K__14':'0.211%', 'L__14':'0.211%', 'M__14':'0.211%', 'N__14':'0.211%', 'O__14':'0.211%', 'P__14':'0.211%',                                                                       
                                                                                              'F__15':'0.211%', 'G__15':'0.211%', 'H__15':'0.211%', 'J__15':'0.211%', 'K__15':'0.211%', 'L__15':'0.211%', 'M__15':'0.211%', 'N__15':'0.211%', 'O__15':'0.211%',                                                                                         
                                                                                                                'G__16':'0.211%', 'H__16':'0.211%', 'J__16':'0.211%',                   'L__16':'0.211%', 'M__16':'0.211%', 'N__16':'0.211%',                                                                                                           
                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                        
    }
  #################################################################################################################################################

  def _set_boron_ppm_positions(self):
    """ Sets the specification for TREAT assembly boron ppm positions """
    
  #################################################################################################################################################
  # Sets the boron impurity values in the active fuel region in each autofilled element position
    self.fuel_ppm_positions ={
                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                'G___4':'5.9 ppm', 'H___4':'5.9 ppm', 'J___4':'5.9 ppm',                    'L___4':'5.9 ppm', 'M___4':'5.9 ppm', 'N___4':'5.9 ppm',                                                                                                           
                                                                                             'F___5':'5.9 ppm', 'G___5':'5.9 ppm', 'H___5':'5.9 ppm', 'J___5':'5.9 ppm', 'K___5':'5.9 ppm', 'L___5':'5.9 ppm', 'M___5':'5.9 ppm', 'N___5':'5.9 ppm', 'O___5':'5.9 ppm',                                                                                         
                                                                          'E___6':'5.9 ppm', 'F___6':'5.9 ppm', 'G___6':'5.9 ppm', 'H___6':'5.9 ppm', 'J___6':'5.9 ppm', 'K___6':'5.9 ppm', 'L___6':'5.9 ppm', 'M___6':'5.9 ppm', 'N___6':'5.9 ppm', 'O___6':'5.9 ppm', 'P___6':'5.9 ppm',                                                                       
                                                       'D___7':'5.9 ppm', 'E___7':'5.9 ppm', 'F___7':'5.9 ppm', 'G___7':'5.9 ppm', 'H___7':'5.9 ppm', 'J___7':'5.9 ppm', 'K___7':'5.9 ppm', 'L___7':'5.9 ppm', 'M___7':'5.9 ppm', 'N___7':'5.9 ppm', 'O___7':'5.9 ppm', 'P___7':'5.9 ppm', 'R___7':'5.9 ppm',                                                     
                                                       'D___8':'5.9 ppm', 'E___8':'5.9 ppm', 'F___8':'5.9 ppm', 'G___8':'5.9 ppm', 'H___8':'5.9 ppm', 'J___8':'5.9 ppm', 'K___8':'5.9 ppm', 'L___8':'5.9 ppm', 'M___8':'5.9 ppm', 'N___8':'5.9 ppm', 'O___8':'5.9 ppm', 'P___8':'5.9 ppm', 'R___8':'5.9 ppm',                                                     
                                                       'D___9':'5.9 ppm', 'E___9':'5.9 ppm', 'F___9':'5.9 ppm', 'G___9':'5.9 ppm', 'H___9':'5.9 ppm', 'J___9':'5.9 ppm', 'K___9':'5.9 ppm', 'L___9':'5.9 ppm', 'M___9':'5.9 ppm', 'N___9':'5.9 ppm', 'O___9':'5.9 ppm', 'P___9':'5.9 ppm', 'R___9':'5.9 ppm',                                                     
                                                                          'E__10':'5.9 ppm', 'F__10':'5.9 ppm', 'G__10':'5.9 ppm', 'H__10':'5.9 ppm', 'J__10':'5.9 ppm', 'K__10':'5.9 ppm', 'L__10':'5.9 ppm', 'M__10':'5.9 ppm', 'N__10':'5.9 ppm', 'O__10':'5.9 ppm', 'P__10':'5.9 ppm',                                                                       
                                                       'D__11':'5.9 ppm', 'E__11':'5.9 ppm', 'F__11':'5.9 ppm', 'G__11':'5.9 ppm', 'H__11':'5.9 ppm', 'J__11':'5.9 ppm', 'K__11':'5.9 ppm', 'L__11':'5.9 ppm', 'M__11':'5.9 ppm', 'N__11':'5.9 ppm', 'O__11':'5.9 ppm', 'P__11':'5.9 ppm', 'R__11':'5.9 ppm',                                                     
                                                       'D__12':'5.9 ppm', 'E__12':'5.9 ppm', 'F__12':'5.9 ppm', 'G__12':'5.9 ppm', 'H__12':'5.9 ppm', 'J__12':'5.9 ppm', 'K__12':'5.9 ppm', 'L__12':'5.9 ppm', 'M__12':'5.9 ppm', 'N__12':'5.9 ppm', 'O__12':'5.9 ppm', 'P__12':'5.9 ppm', 'R__12':'5.9 ppm',                                                     
                                                       'D__13':'5.9 ppm', 'E__13':'5.9 ppm', 'F__13':'5.9 ppm', 'G__13':'5.9 ppm', 'H__13':'5.9 ppm', 'J__13':'5.9 ppm', 'K__13':'5.9 ppm', 'L__13':'5.9 ppm', 'M__13':'5.9 ppm', 'N__13':'5.9 ppm', 'O__13':'5.9 ppm', 'P__13':'5.9 ppm', 'R__13':'5.9 ppm',                                                     
                                                                          'E__14':'5.9 ppm', 'F__14':'5.9 ppm', 'G__14':'5.9 ppm', 'H__14':'5.9 ppm', 'J__14':'5.9 ppm', 'K__14':'5.9 ppm', 'L__14':'5.9 ppm', 'M__14':'5.9 ppm', 'N__14':'5.9 ppm', 'O__14':'5.9 ppm', 'P__14':'5.9 ppm',                                                                       
                                                                                             'F__15':'5.9 ppm', 'G__15':'5.9 ppm', 'H__15':'5.9 ppm', 'J__15':'5.9 ppm', 'K__15':'5.9 ppm', 'L__15':'5.9 ppm', 'M__15':'5.9 ppm', 'N__15':'5.9 ppm', 'O__15':'5.9 ppm',                                                                                         
                                                                                                                'G__16':'5.9 ppm', 'H__16':'5.9 ppm', 'J__16':'5.9 ppm',                    'L__16':'5.9 ppm', 'M__16':'5.9 ppm', 'N__16':'5.9 ppm',                                                                                                           
                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                        
    }
  # Sets the boron impurity values in the dummy elements in each autofilled element position
    self.refl_ppm_positions ={
    'A___1':'CP2', 'B___1':'CP2', 'C___1':'CP2', 'D___1':'CP2', 'E___1':'CP2', 'F___1':'CP2', 'G___1':'CP2', 'H___1':'CP2', 'J___1':'CP2', 'K___1':'CP2', 'L___1':'CP2', 'M___1':'CP2', 'N___1':'CP2', 'O___1':'CP2', 'P___1':'CP2', 'R___1':'CP2','S___1':'CP2', 'T___1':'CP2', 'U___1':'CP2',
    'A___2':'CP2', 'B___2':'CP2', 'C___2':'CP2', 'D___2':'CP2', 'E___2':'CP2', 'F___2':'CP2', 'G___2':'CP2', 'H___2':'CP2', 'J___2':'CP2', 'K___2':'CP2', 'L___2':'CP2', 'M___2':'CP2', 'N___2':'CP2', 'O___2':'CP2', 'P___2':'CP2', 'R___2':'CP2','S___2':'CP2', 'T___2':'CP2', 'U___2':'CP2',
    'A___3':'CP2', 'B___3':'CP2', 'C___3':'CP2', 'D___3':'CP2', 'E___3':'CP2', 'F___3':'CP2', 'G___3':'CP2', 'H___3':'CP2', 'J___3':'CP2', 'K___3':'CP2', 'L___3':'CP2', 'M___3':'CP2', 'N___3':'CP2', 'O___3':'CP2', 'P___3':'CP2', 'R___3':'CP2','S___3':'CP2', 'T___3':'CP2', 'U___3':'CP2',
    'A___4':'CP2', 'B___4':'CP2', 'C___4':'CP2', 'D___4':'CP2', 'E___4':'CP2', 'F___4':'CP2',                                              'K___4':'CP2',                                              'O___4':'CP2', 'P___4':'CP2', 'R___4':'CP2','S___4':'CP2', 'T___4':'CP2', 'U___4':'CP2',
    'A___5':'CP2', 'B___5':'CP2', 'C___5':'CP2', 'D___5':'CP2', 'E___5':'CP2',                                                                                                                                        'P___5':'CP2', 'R___5':'CP2','S___5':'CP2', 'T___5':'CP2', 'U___5':'CP2',
    'A___6':'CP2', 'B___6':'CP2', 'C___6':'CP2', 'D___6':'CP2',                                                                                                                                                                      'R___6':'CP2','S___6':'CP2', 'T___6':'CP2', 'U___6':'CP2',
    'A___7':'CP2', 'B___7':'CP2', 'C___7':'CP2',                                                                                                                                                                                                   'S___7':'CP2', 'T___7':'CP2', 'U___7':'CP2',
    'A___8':'CP2', 'B___8':'CP2', 'C___8':'CP2',                                                                                                                                                                                                   'S___8':'CP2', 'T___8':'CP2', 'U___8':'CP2',
    'A___9':'CP2', 'B___9':'CP2', 'C___9':'CP2',                                                                                                                                                                                                   'S___9':'CP2', 'T___9':'CP2', 'U___9':'CP2',
    'A__10':'CP2', 'B__10':'CP2', 'C__10':'CP2', 'D__10':'CP2',                                                                                                                                                                      'R__10':'CP2','S__10':'CP2', 'T__10':'CP2', 'U__10':'CP2',
    'A__11':'CP2', 'B__11':'CP2', 'C__11':'CP2',                                                                                                                                                                                                   'S__11':'CP2', 'T__11':'CP2', 'U__11':'CP2',
    'A__12':'CP2', 'B__12':'CP2', 'C__12':'CP2',                                                                                                                                                                                                   'S__12':'CP2', 'T__12':'CP2', 'U__12':'CP2',
    'A__13':'CP2', 'B__13':'CP2', 'C__13':'CP2',                                                                                                                                                                                                   'S__13':'CP2', 'T__13':'CP2', 'U__13':'CP2',
    'A__14':'CP2', 'B__14':'CP2', 'C__14':'CP2', 'D__14':'CP2',                                                                                                                                                                      'R__14':'CP2','S__14':'CP2', 'T__14':'CP2', 'U__14':'CP2',
    'A__15':'CP2', 'B__15':'CP2', 'C__15':'CP2', 'D__15':'CP2', 'E__15':'CP2',                                                                                                                                        'P__15':'CP2', 'R__15':'CP2','S__15':'CP2', 'T__15':'CP2', 'U__15':'CP2',
    'A__16':'CP2', 'B__16':'CP2', 'C__16':'CP2', 'D__16':'CP2', 'E__16':'CP2', 'F__16':'CP2',                                              'K__16':'CP2',                                              'O__16':'CP2', 'P__16':'CP2', 'R__16':'CP2','S__16':'CP2', 'T__16':'CP2', 'U__16':'CP2',
    'A__17':'CP2', 'B__17':'CP2', 'C__17':'CP2', 'D__17':'CP2', 'E__17':'CP2', 'F__17':'CP2', 'G__17':'CP2', 'H__17':'CP2', 'J__17':'CP2', 'K__17':'CP2', 'L__17':'CP2', 'M__17':'CP2', 'N__17':'CP2', 'O__17':'CP2', 'P__17':'CP2', 'R__17':'CP2','S__17':'CP2', 'T__17':'CP2', 'U__17':'CP2',
    'A__18':'CP2', 'B__18':'CP2', 'C__18':'CP2', 'D__18':'CP2', 'E__18':'CP2', 'F__18':'CP2', 'G__18':'CP2', 'H__18':'CP2', 'J__18':'CP2', 'K__18':'CP2', 'L__18':'CP2', 'M__18':'CP2', 'N__18':'CP2', 'O__18':'CP2', 'P__18':'CP2', 'R__18':'CP2','S__18':'CP2', 'T__18':'CP2', 'U__18':'CP2',
    'A__19':'CP2', 'B__19':'CP2', 'C__19':'CP2', 'D__19':'CP2', 'E__19':'CP2', 'F__19':'CP2', 'G__19':'CP2', 'H__19':'CP2', 'J__19':'CP2', 'K__19':'CP2', 'L__19':'CP2', 'M__19':'CP2', 'N__19':'CP2', 'O__19':'CP2', 'P__19':'CP2', 'R__19':'CP2','S__19':'CP2', 'T__19':'CP2', 'U__19':'CP2',
    }
  #################################################################################################################################################

  def _set_cladding_positions(self):
    """ Sets the specification for TREAT dummy element cladding material positions """
    
  #################################################################################################################################################
  # Sets the cladding types in the dummy elements in each autofilled element position
    self.refl_clad_positions ={
    'A___1':'Al', 'B___1':'Al', 'C___1':'Al', 'D___1':'Al', 'E___1':'Al', 'F___1':'Al', 'G___1':'Al', 'H___1':'Al', 'J___1':'Al', 'K___1':'Al', 'L___1':'Al', 'M___1':'Al', 'N___1':'Al', 'O___1':'Al', 'P___1':'Al', 'R___1':'Al','S___1':'Al', 'T___1':'Al', 'U___1':'Al',
    'A___2':'Al', 'B___2':'Al', 'C___2':'Al', 'D___2':'Al', 'E___2':'Al', 'F___2':'Al', 'G___2':'Al', 'H___2':'Al', 'J___2':'Al', 'K___2':'Al', 'L___2':'Al', 'M___2':'Al', 'N___2':'Al', 'O___2':'Al', 'P___2':'Al', 'R___2':'Al','S___2':'Al', 'T___2':'Al', 'U___2':'Al',
    'A___3':'Al', 'B___3':'Al', 'C___3':'Al', 'D___3':'Al', 'E___3':'Al', 'F___3':'Al', 'G___3':'Al', 'H___3':'Al', 'J___3':'Zr', 'K___3':'Al', 'L___3':'Zr', 'M___3':'Al', 'N___3':'Al', 'O___3':'Al', 'P___3':'Al', 'R___3':'Al','S___3':'Al', 'T___3':'Al', 'U___3':'Al',
    'A___4':'Al', 'B___4':'Al', 'C___4':'Al', 'D___4':'Al', 'E___4':'Al', 'F___4':'Al',                                           'K___4':'Zr',                                           'O___4':'Al', 'P___4':'Al', 'R___4':'Al','S___4':'Al', 'T___4':'Al', 'U___4':'Al',
    'A___5':'Al', 'B___5':'Al', 'C___5':'Al', 'D___5':'Al', 'E___5':'Zr',                                                                                                                               'P___5':'Zr', 'R___5':'Al','S___5':'Al', 'T___5':'Al', 'U___5':'Al',
    'A___6':'Al', 'B___6':'Al', 'C___6':'Al', 'D___6':'Al',                                                                                                                                                           'R___6':'Al','S___6':'Al', 'T___6':'Al', 'U___6':'Al',
    'A___7':'Al', 'B___7':'Al', 'C___7':'Al',                                                                                                                                                                                      'S___7':'Al', 'T___7':'Al', 'U___7':'Al',
    'A___8':'Al', 'B___8':'Al', 'C___8':'Al',                                                                                                                                                                                      'S___8':'Al', 'T___8':'Al', 'U___8':'Al',
    'A___9':'Al', 'B___9':'Al', 'C___9':'Zr',                                                                                                                                                                                      'S___9':'Zr', 'T___9':'Al', 'U___9':'Al',
    'A__10':'Al', 'B__10':'Al', 'C__10':'Al', 'D__10':'Zr',                                                                                                                                                           'R__10':'Zr','S__10':'Al', 'T__10':'Al', 'U__10':'Al',
    'A__11':'Al', 'B__11':'Al', 'C__11':'Zr',                                                                                                                                                                                      'S__11':'Zr', 'T__11':'Al', 'U__11':'Al',
    'A__12':'Al', 'B__12':'Al', 'C__12':'Al',                                                                                                                                                                                      'S__12':'Al', 'T__12':'Al', 'U__12':'Al',
    'A__13':'Al', 'B__13':'Al', 'C__13':'Al',                                                                                                                                                                                      'S__13':'Al', 'T__13':'Al', 'U__13':'Al',
    'A__14':'Al', 'B__14':'Al', 'C__14':'Al', 'D__14':'Al',                                                                                                                                                           'R__14':'Al','S__14':'Al', 'T__14':'Al', 'U__14':'Al',
    'A__15':'Al', 'B__15':'Al', 'C__15':'Al', 'D__15':'Al', 'E__15':'Zr',                                                                                                                               'P__15':'Zr', 'R__15':'Al','S__15':'Al', 'T__15':'Al', 'U__15':'Al',
    'A__16':'Al', 'B__16':'Al', 'C__16':'Al', 'D__16':'Al', 'E__16':'Al', 'F__16':'Al',                                           'K__16':'Zr',                                           'O__16':'Al', 'P__16':'Al', 'R__16':'Al','S__16':'Al', 'T__16':'Al', 'U__16':'Al',
    'A__17':'Al', 'B__17':'Al', 'C__17':'Al', 'D__17':'Al', 'E__17':'Al', 'F__17':'Al', 'G__17':'Al', 'H__17':'Al', 'J__17':'Zr', 'K__17':'Al', 'L__17':'Zr', 'M__17':'Al', 'N__17':'Al', 'O__17':'Al', 'P__17':'Al', 'R__17':'Al','S__17':'Al', 'T__17':'Al', 'U__17':'Al',
    'A__18':'Al', 'B__18':'Al', 'C__18':'Al', 'D__18':'Al', 'E__18':'Al', 'F__18':'Al', 'G__18':'Al', 'H__18':'Al', 'J__18':'Al', 'K__18':'Al', 'L__18':'Al', 'M__18':'Al', 'N__18':'Al', 'O__18':'Al', 'P__18':'Al', 'R__18':'Al','S__18':'Al', 'T__18':'Al', 'U__18':'Al',
    'A__19':'Al', 'B__19':'Al', 'C__19':'Al', 'D__19':'Al', 'E__19':'Al', 'F__19':'Al', 'G__19':'Al', 'H__19':'Al', 'J__19':'Al', 'K__19':'Al', 'L__19':'Al', 'M__19':'Al', 'N__19':'Al', 'O__19':'Al', 'P__19':'Al', 'R__19':'Al','S__19':'Al', 'T__19':'Al', 'U__19':'Al',
    }

  #################################################################################################################################################

  def _set_slot_positions(self):
    """ Sets the specifications for the slotted dummy element positions """
    
  #################################################################################################################################################
  # No dummy slotted elements in this core
    self.slot_height_positions ={
    }

  #################################################################################################################################################


  def _set_rcca_positions(self):
    """ Sets the specifications for the control rod element positions """
    
  #################################################################################################################################################
    # The keys that are present in these lists are the only positions that can physically accept control rods   

    # True / False whether the position has a control rod 
    self.rcca_positions = {
                                          'D___2': 0 ,                                                                              'R___2': 0 ,
                                                                              'H___3': 0 ,      'M___3': 0 ,
      'B___4': 0 ,                                          'F___4': 0 ,                                          'O___4': 0 ,                                          'T___4': 0 ,
                                          'D___6': 0 ,                        'H___6': 1 ,      'M___6': 1 ,                        'R___6': 0 ,
                        'C___8': 0 ,                        'F___8': 1 ,                                          'O___8': 1 ,                        'S___8': 0 ,
                        'C__12': 0 ,                        'F__12': 1 ,                                          'O__12': 1 ,                        'S__12': 0 ,
                                          'D__14': 0 ,                        'H__14': 1 ,      'M__14': 1 ,                        'R__14': 0 ,
      'B__16': 0 ,                                          'F__16': 0 ,                                          'O__16': 0 ,                                          'T__16': 0 ,
                                                                              'H__17': 0 ,      'M__17': 0 ,
                                          'D__18': 0 ,                                                                              'R__18': 0 ,
    }

    # Which bank we should be drawing from to get the insertion level
    self.rcca_banks = {
                                          'D___2': 'None' ,                                                                         'R___2': 'None' ,
                                                                              'H___3': 'None' , 'M___3': 'None' ,
      'B___4': 'None' ,                                     'F___4': 'None' ,                                     'O___4': 'None' ,                                     'T___4': 'None' ,
                                          'D___6': 'None' ,                   'H___6':  'MCM' , 'M___6':  'MCM' ,                   'R___6': 'None' ,
                        'C___8': 'None' ,                   'F___8':  'MCM' ,                                     'O___8':  'MCM' ,                   'S___8': 'None' ,
                        'C__12': 'None' ,                   'F__12':  'MCM' ,                                     'O__12':  'MCM' ,                   'S__12': 'None' ,
                                          'D__14': 'None' ,                   'H__14':  'MCM' , 'M__14':  'MCM' ,                   'R__14': 'None' ,
      'B__16': 'None' ,                                     'F__16': 'None' ,                                     'O__16': 'None' ,                                     'T__16': 'None' ,
                                                                              'H__17': 'None' , 'M__17': 'None' ,
                                          'D__18': 'None' ,                                                                         'R__18': 'None' ,
    }

    # Which type of control rod is in the spot
    # TODO Check the types. Believe the minimum critical core was built early enough to use type I and assume that they used
    #      shutdown type rods, but should check.
    self.rcca_type = {
                                          'D___2': 'None' ,                                                                                                                     'R___2': 'None' ,
                                                                                         'H___3': 'None' ,            'M___3': 'None' ,
      'B___4': 'None' ,                                     'F___4': 'None' ,                                                                      'O___4': 'None' ,                                                'T___4': 'None' ,
                                          'D___6': 'None' ,                              'H___6': 'Shutdown Type I' , 'M___6': 'Shutdown Type I' ,                              'R___6': 'None' ,
                        'C___8': 'None' ,                   'F___8': 'Shutdown Type I' ,                                                           'O___8': 'Shutdown Type I' ,                   'S___8': 'None' ,
                        'C__12': 'None' ,                   'F__12': 'Shutdown Type I' ,                                                           'O__12': 'Shutdown Type I' ,                   'S__12': 'None' ,
                                          'D__14': 'None' ,                              'H__14': 'Shutdown Type I' , 'M__14': 'Shutdown Type I' ,                              'R__14': 'None' ,
      'B__16': 'None' ,                                     'F__16': 'None' ,                                                                      'O__16': 'None' ,                                                'T__16': 'None' ,
                                                                                         'H__17': 'None' ,            'M__17': 'None' ,
                                          'D__18': 'None' ,                                                                                                                     'R__18': 'None' ,
    }

  #################################################################################################################################################

  def _make_core_universe(self):
    # Goes through and actually autofills the positions
    """ Creates the TREAT core lattice universe """

    lattice = TemplatedLattice(c.ROOT_LATTICE, name='Core Lattice')
    lattice.setTemplate(self.core_lattice_template)
    lattice.pitch = [c.latticePitch, c.latticePitch]
    lattice.lower_left = [-c.n_lattice_positions * c.latticePitch / 2.0, -c.n_lattice_positions * c.latticePitch / 2.0]
    for pos in self.core_positions:
      # Do the fueled elements first
      if pos in self.fuel_wgt_positions:
        # First set the fuel weight percent and the boron ppm concentration for this position
        wgt = self.fuel_wgt_positions[pos]
        boron = self.fuel_ppm_positions[pos]
        if pos in self.rcca_positions: # This is a position that can accept a control rod. 
          # For user comprehension, I am keeping two separate checks for whether it is physically possible to have a
          # control rod in a given spot, and whether a control rod actually exists there. This is so that if the
          # user makes edits to a benchmark, or uses it as the base when building an arbitrary loading pattern of
          # their own, they do not place the control rod in an invalid position. In the future it may be decided that
          # it is better to remove this redundant check and simply check for the positions that have a control rod.
          if self.rcca_positions[pos]: # We have a control rod here
            bank = self.rcca_banks[pos]
            rod_type = self.rcca_type[pos]
            lattice.setPosition(pos, self.elements.u_rcca[bank,rod_type,wgt,boron])
          else: # We don't have a control rod here
            lattice.setPosition(pos, self.elements.u_fuel_p[wgt,boron])
        else: # Can't have a control rod here
          lattice.setPosition(pos, self.elements.u_fuel_p[wgt,boron])
      # Now do the access hole dummy elements
      if pos in self.refl_ppm_positions:
        boron = self.refl_ppm_positions[pos]
        clad = self.refl_clad_positions[pos]
        # We have a position with a dummy element
        if clad == 'Zr':
          lattice.setPosition(pos, self.elements.u_null_zr_p[boron])
        elif clad == 'Al':
          lattice.setPosition(pos, self.elements.u_null_al_p[boron])
    lattice.finalize()
    
    self.u_coreLattice = lattice

